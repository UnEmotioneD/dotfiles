# i3 config file (v4)

set $mod Mod4

# i3status font
font pango:DejaVu Sans Mono 11

# Start XDG autostart .desktop files using dex
exec --no-startup-id dex --autostart --environment i3

# lock with xss-lock, nm-applet and pactl
exec --no-startup-id xss-lock --transfer-sleep-lock -- i3lock --nofork

# gui NetworkManager
exec --no-startup-id nm-applet

exec_always --no-startup-id picom
exec_always --no-startup-id feh --bg-scale ~/Pictures/wallpaper/kagura.png

# keyboard keyrepeat(delay ms) / delay(frequency per sec)
#  1000 / 40 == 25 ms delay per each input
exec_always --no-startup-id xset r rate 250 75
# monitor script
exec_always --no-startup-id ~/.config/i3/scripts/monitor.sh
# input source
exec_always --no-startup-id ibus exit
exec_always --no-startup-id fcitx5 -d
# force mouse pointer to normal
exec_always --no-startup-id xsetroot -cursor_name left_ptr
# touchpad turn on natural scrolling
# $ xinput list
# look for touchpad's id
exec_always --no-startup-id xinput set-prop 12 "libinput Natural Scrolling Enabled" 1

# Use pactl to adjust volume in PulseAudio.
set $refresh_i3status killall -SIGUSR1 i3status
bindsym XF86AudioRaiseVolume exec --no-startup-id pactl set-sink-volume @DEFAULT_SINK@     +10% && $refresh_i3status
bindsym XF86AudioLowerVolume exec --no-startup-id pactl set-sink-volume @DEFAULT_SINK@     -10% && $refresh_i3status
bindsym XF86AudioMute        exec --no-startup-id pactl set-sink-mute   @DEFAULT_SINK@   toggle && $refresh_i3status
bindsym XF86AudioMicMute     exec --no-startup-id pactl set-source-mute @DEFAULT_SOURCE@ toggle && $refresh_i3status

# screen shot
bindsym Mod1+shift+j exec --no-startup-id flameshot gui    --clipboard --path ~/Pictures/screenshots
bindsym Mod1+shift+k exec --no-startup-id flameshot screen --clipboard --path ~/Pictures/screenshots
bindsym Mod1+shift+l exec --no-startup-id flameshot full   --clipboard --path ~/Pictures/screenshots

# mouse+mod to drag floating window
floating_modifier $mod

# move tiling windows via drag & drop by left-clicking into the title bar,
# or left-clicking anywhere into the window while holding the floating modifier.
tiling_drag modifier titlebar

bindsym $mod+Return exec --no-startup-id wezterm
bindsym $mod+b      exec --no-startup-id google-chrome

bindsym Mod1+q kill

# dmenu (.desktop app only)
bindsym Mod1+space exec --no-startup-id dmenu_run
#bindsym Mod1+space exec --no-startup-id i3-dmenu-desktop

focus_wrapping no
# change focus
bindsym $mod+h focus left
bindsym $mod+j focus down
bindsym $mod+k focus up
bindsym $mod+l focus right

# move focused window
bindsym $mod+Shift+h move left
bindsym $mod+Shift+j move down
bindsym $mod+Shift+k move up
bindsym $mod+Shift+l move right

# split in horizontal/vertical orientation
#bindsym $mod+h split h
#bindsym $mod+v split v

# enter fullscreen mode for the focused container
bindsym $mod+semicolon fullscreen toggle

# change container layout
#bindsym $mod+s layout stacking
#bindsym $mod+w layout tabbed
#bindsym $mod+e layout toggle split

# toggle tiling / floating
bindsym $mod+Shift+space floating toggle

# change focus between tiling / floating windows
bindsym $mod+space focus mode_toggle

# focus the parent/chile container
#bindsym $mod+a focus parent
#bindsym $mod+d focus child

# workspace declaration
set $ws1 "U: term"
set $ws2 "I: web"
set $ws3 "O: code"
set $ws4 "P: file"
set $ws5 "N: note"
set $ws6 "M: message"
set $ws7 "Y: extend"

# switch to workspace
bindsym $mod+u workspace $ws1
bindsym $mod+i workspace $ws2
bindsym $mod+o workspace $ws3
bindsym $mod+p workspace $ws4
bindsym $mod+n workspace $ws5
bindsym $mod+m workspace $ws6
bindsym $mod+y workspace $ws7

# move focused container to workspace
bindsym $mod+Shift+u move container to workspace $ws1
bindsym $mod+Shift+i move container to workspace $ws2
bindsym $mod+Shift+o move container to workspace $ws3
bindsym $mod+Shift+p move container to workspace $ws4
bindsym $mod+Shift+n move container to workspace $ws5
bindsym $mod+Shift+m move container to workspace $ws6
bindsym $mod+Shift+y move container to workspace $ws7

# restart i3 and related apps
bindsym $mod+Shift+r restart

# power menu
set $power_menu System (p)ower off | (r)eboot | (l)ock | (e)xit
mode "$power_menu" {
        bindsym p exec --no-startup-id systemctl poweroff, mode "default"
        bindsym r exec --no-startup-id systemctl reboot,   mode "default"
        bindsym l exec --no-startup-id i3lock,             mode "default"
        bindsym e exec --no-startup-id i3-msg exit,        mode "default"

        # back to normal: Enter or Escape
        bindsym Return mode "default"
        bindsym Escape mode "default"
}
bindsym $mod+Shift+q mode "$power_menu"

# resize window (you can also use the mouse for that)
mode "resize" {
        bindsym h resize shrink width  10 px or 10 ppt
        bindsym j resize shrink height 10 px or 10 ppt
        bindsym k resize grow height   10 px or 10 ppt
        bindsym l resize grow width    10 px or 10 ppt

        # back to normal: Enter or Escape or $mod+r
        bindsym Return mode "default"
        bindsym Escape mode "default"
        bindsym $mod+r mode "default"
}

bindsym $mod+r mode "resize"

# i3status
bar {
        status_command i3status
}

# assign apps to workspace
for_window [class="Alacritty"]              move to workspace $ws1, focus
for_window [class="org.wezfurlong.wezterm"] move to workspace $ws1, focus
for_window [class="Google-chrome"]          move to workspace $ws2, focus
for_window [class="Code"]                   move to workspace $ws3, focus
for_window [class="org.gnome.Nautilus"]     move to workspace $ws4, focus
for_window [class="dicsord"]                move to workspace $ws6, focus
for_window [class="Slack"]                  move to workspace $ws6, focus

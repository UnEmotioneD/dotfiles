-- key mapping for vim
-- Convert input source as English and sends 'escape' if inputSource is not English.
-- Sends 'escape' if inputSource is English.
-- key bindding reference --> https://www.hammerspoon.org/docs/hs.hotkey.html
local inputEnglish = "com.apple.keylayout.ABC"
local esc_bind

function TO_ENG()
	local inputSource = hs.keycodes.currentSourceID()
	if not (inputSource == inputEnglish) then
		hs.keycodes.currentSourceID(inputEnglish)
	end
	esc_bind:disable()
	hs.eventtap.keyStroke({}, "escape")
	esc_bind:enable()
end

esc_bind = hs.hotkey.new({}, "escape", TO_ENG):enable()

-- Input source to English when focus on terminal apps
--[[
hs.window.filter.new({ "Terminal", "Alacritty", "Wezterm", "Ghostty" }):subscribe(hs.window.filter.windowFocused, function()
	local inputSource = hs.keycodes.currentSourceID()
	if not (inputSource == inputEnglish) then
		hs.keycodes.currentSourceID(inputEnglish)
	end
end)
--]]
